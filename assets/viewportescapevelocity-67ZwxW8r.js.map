{"version":3,"file":"viewportescapevelocity-67ZwxW8r.js","sources":["../../public/escapeVelocity/viewportescapevelocity.js"],"sourcesContent":["/**\n * Escape Velocity Viewport Module\n * \n * This module handles loading the escape-velocity.html content in an iframe\n * that appears on top of the Three.js scene.\n */\n\nimport gsap from 'gsap';\nimport { handleReturnToGames, monkeyPatchReturnButtons } from '../../src/landing/ui/viewportStyling.js';\n\n// Keep track of the viewport DOM elements\nlet viewportContainer = null;\nlet iframe = null;\nlet closeButton = null;\n\n/**\n * Creates and shows the escape velocity game viewport with futuristic animations.\n */\nexport function showEscapeVelocityViewport() {\n    // If viewport already exists, just show it\n    if (viewportContainer) {\n        viewportContainer.style.display = 'flex';\n        return;\n    }\n\n    console.log(\"Creating escape velocity viewport\");\n\n    // Create container for the viewport\n    viewportContainer = document.createElement('div');\n    viewportContainer.id = 'escape-velocity-viewport-container';\n    viewportContainer.style.position = 'fixed';\n    viewportContainer.style.top = '50%';\n    viewportContainer.style.left = '50%';\n    viewportContainer.style.transform = 'translate(-50%, -50%)';\n    viewportContainer.style.width = '80%';\n    viewportContainer.style.maxWidth = '1440px';\n    viewportContainer.style.height = '80vh';\n    viewportContainer.style.backgroundColor = 'rgba(0, 0, 0, 0.9)';\n    viewportContainer.style.border = '2px solid #007bff';\n    viewportContainer.style.borderRadius = '10px';\n    viewportContainer.style.boxShadow = '0 0 20px rgba(0, 123, 255, 0.5)';\n    viewportContainer.style.zIndex = '900';\n    viewportContainer.style.display = 'flex';\n    viewportContainer.style.flexDirection = 'column';\n    viewportContainer.style.overflow = 'hidden';\n    \n    // Create header with title and close button\n    const header = document.createElement('div');\n    header.style.display = 'flex';\n    header.style.justifyContent = 'space-between';\n    header.style.alignItems = 'center';\n    header.style.padding = '10px 15px';\n    header.style.backgroundColor = '#007bff';\n    header.style.color = 'white';\n    header.style.borderTopLeftRadius = '8px';\n    header.style.borderTopRightRadius = '8px';\n    \n    const title = document.createElement('h2');\n    title.textContent = 'Escape Velocity Game';\n    title.style.margin = '0';\n    title.style.fontSize = '1.2rem';\n    \n    // Create a container for the buttons\n    const buttonsContainer = document.createElement('div');\n    buttonsContainer.style.display = 'flex';\n    buttonsContainer.style.alignItems = 'center';\n    buttonsContainer.style.gap = '10px'; // Space between buttons\n    \n    // Create return button\n    const returnButton = document.createElement('button');\n    returnButton.textContent = '↩';\n    returnButton.style.background = 'none';\n    returnButton.style.border = 'none';\n    returnButton.style.color = 'white';\n    returnButton.style.fontSize = '1.2rem';\n    returnButton.style.cursor = 'pointer';\n    returnButton.style.padding = '0 5px';\n    returnButton.style.lineHeight = '1';\n    returnButton.style.marginRight = '5px';\n    \n    closeButton = document.createElement('button');\n    closeButton.textContent = '✕';\n    closeButton.style.background = 'none';\n    closeButton.style.border = 'none';\n    closeButton.style.color = 'white';\n    closeButton.style.fontSize = '1.5rem';\n    closeButton.style.cursor = 'pointer';\n    closeButton.style.padding = '0 5px';\n    closeButton.style.lineHeight = '1';\n    \n    // Add buttons to container\n    buttonsContainer.appendChild(returnButton);\n    buttonsContainer.appendChild(closeButton);\n    \n    header.appendChild(title);\n    header.appendChild(buttonsContainer);\n    viewportContainer.appendChild(header);\n    \n    // Create iframe to load the escape-velocity.html content\n    iframe = document.createElement('iframe');\n    iframe.src = '/games/escape-velocity.html';\n    iframe.style.width = '100%';\n    iframe.style.height = '100%';\n    iframe.style.border = 'none';\n    iframe.style.backgroundColor = '#222';\n    \n    // Add event listener for iframe load errors\n    iframe.onerror = () => {\n        console.error(\"Failed to load iframe content\");\n    };\n    \n    // Add event listener for iframe load success\n    iframe.onload = () => {\n        console.log(\"Iframe loaded successfully\");\n    };\n    \n    viewportContainer.appendChild(iframe);\n    document.body.appendChild(viewportContainer);\n    \n    // Create opening animations using a timeline\n    const tl = gsap.timeline();\n    tl.from(viewportContainer, {\n        opacity: 0,\n        scale: 0.8,\n        duration: 0.4,\n        ease: \"power2.out\"\n    });\n    tl.from(header, {\n        y: -50,\n        duration: 0.3,\n        ease: \"back.out(1.7)\"\n    }, \"-=0.2\");\n    tl.from(iframe, {\n        opacity: 0,\n        y: 20,\n        duration: 0.3,\n        ease: \"power2.out\"\n    }, \"-=0.1\");\n    \n    // Add event listener for close button\n    closeButton.addEventListener('click', hideEscapeVelocityViewport);\n    \n    // Add event listener for return button to load games HTML in the current iframe\n    returnButton.addEventListener('click', function(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        \n        // Change the title to Games\n        title.textContent = 'Psyche Mission Games';\n        \n        // Load the games HTML in the iframe\n        iframe.src = './games/games.html';\n        console.log(\"Loading games HTML in escape velocity viewport\");\n    });\n    \n    // Add event listener for Escape key\n    document.addEventListener('keydown', handleKeyDown);\n    \n    // Run the monkey patch to ensure the return button works\n    setTimeout(monkeyPatchReturnButtons, 100);\n}\n\n/**\n * Hides the escape velocity viewport with closing animation.\n */\nexport function hideEscapeVelocityViewport() {\n    if (!viewportContainer) return;\n\n    gsap.to(viewportContainer, {\n        opacity: 0,\n        scale: 0.8,\n        duration: 0.3,\n        ease: \"power2.in\",\n        onComplete: () => {\n            destroyEscapeVelocityViewport();\n            document.body.classList.add(\"overlay-open\");\n        }\n    });\n}\n\n/**\n * Handles keydown events for the viewport.\n */\nfunction handleKeyDown(e) {\n    if (e.key === 'Escape') {\n        hideEscapeVelocityViewport();\n    }\n}\n\n/**\n * Removes the viewport completely.\n */\nexport function destroyEscapeVelocityViewport() {\n    if (viewportContainer) {\n        closeButton.removeEventListener('click', hideEscapeVelocityViewport);\n        document.removeEventListener('keydown', handleKeyDown);\n        document.body.removeChild(viewportContainer);\n        viewportContainer = null;\n        iframe = null;\n        closeButton = null;\n    }\n}\n"],"names":["viewportContainer","iframe","closeButton","showEscapeVelocityViewport","header","title","buttonsContainer","returnButton","tl","gsap","hideEscapeVelocityViewport","event","handleKeyDown","monkeyPatchReturnButtons","destroyEscapeVelocityViewport","e"],"mappings":"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"}